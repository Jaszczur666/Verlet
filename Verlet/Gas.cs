using System;
using System.Collections.Generic;
using static System.Math;
using System.Text;
using System.Media;

namespace Verlet
{
    class Gas
    {
        public List<Particle> particles;
        public readonly double l = 10.0;
        public double t = 0;
        public double pot = 0;
        readonly Random rand;
        double rnd()
        {
            return rand.NextDouble();
        }
        public Gas()
        {
            particles = new List<Particle>();
            rand = new Random();
        }
        public void Ref1() { 
        particles.Clear();
            string pozycje = "-0.11264 1.38509 -0.8842\r\n-2.46372 -1.3758 0.83913\r\n-3.04667 1.65106 4.39984\r\n4.77126 3.27152 2.80123\r\n-1.89665 4.33426 4.46276\r\n-3.65321 -3.75186 -0.91084\r\n-4.43538 0.96188 3.37922\r\n-3.92288 0.09706 4.20845\r\n-4.73866 -1.59471 -1.44179\r\n-4.09589 3.33637 -0.53396\r\n-2.06836 -0.62874 4.91722\r\n-1.4679 3.75353 1.72678\r\n2.08081 3.34223 3.54096\r\n-2.3707 -1.07581 2.85246\r\n2.33697 -4.5765 -4.47568\r\n1.80309 3.60621 0.6625\r\n-0.7161 -1.33309 -3.89254\r\n1.03466 -2.73177 1.11537\r\n-3.42726 2.49187 -0.34583\r\n-0.20982 1.7692 0.45621\r\n4.34428 -1.45128 3.97468\r\n-1.85386 -0.03305 2.35217\r\n4.91715 -4.98677 4.48266\r\n2.22423 1.44354 2.87326\r\n-4.3673 -0.17378 -1.5054\r\n4.16074 -3.17738 -3.79703\r\n4.37746 -0.73997 1.23516\r\n1.89908 4.46218 -2.87983\r\n-0.20983 1.7399 -2.0182\r\n0.79505 -3.08158 4.6277\r\n-1.01817 4.49539 3.71199\r\n-4.42646 4.58668 1.29968\r\n-3.88311 -2.46079 0.01214\r\n-3.6848 -1.78212 3.67188\r\n-3.6789 -1.9863 -4.30337\r\n4.17603 -2.78597 -4.76006\r\n-3.46779 2.61934 2.05062\r\n2.76234 2.99023 -4.6106\r\n2.67232 -2.17392 4.15315\r\n3.90007 -0.85558 -3.546\r\n-2.92411 -4.36294 -4.93898\r\n-2.5817 0.46129 1.90923\r\n-2.33857 3.50199 -3.55042\r\n-4.26768 1.16938 -1.72329\r\n-1.36358 -1.8074 -0.57514\r\n0.98913 2.73254 1.75029\r\n4.20888 -0.69119 2.99489\r\n-1.74682 -1.41276 -4.3508\r\n-1.64578 -0.74211 -3.25945\r\n-1.577 0.97055 -4.23039\r\n1.33745 -1.45968 -4.57844\r\n-3.9943 1.15102 4.24967\r\n-0.63526 -0.4513 0.53609\r\n3.87609 2.17019 -2.36717\r\n4.85004 4.40957 -0.11262\r\n1.78412 4.29486 -0.98613\r\n-4.73478 -0.47456 4.783\r\n1.34251 -3.47566 -3.29326\r\n0.71098 -3.29523 -1.34598\r\n-3.16074 3.05923 -2.7146\r\n-2.99776 -1.43525 -0.05542\r\n4.96604 -2.32683 4.29715\r\n-1.06799 -0.95206 3.48396\r\n-2.37773 4.0375 -1.15176\r\n-4.53876 -0.58197 2.05041\r\n0.56755 0.83451 1.64772\r\n-3.94816 4.86251 2.80779\r\n-1.76038 2.78286 -2.97851\r\n-0.53643 3.38005 2.10345\r\n1.52429 4.93417 -4.95477\r\n-2.77282 -1.56591 4.60091\r\n1.16088 2.13129 -0.51403\r\n-3.07928 -1.12647 -2.62173\r\n-4.23671 -1.73693 2.25362\r\n0.62672 -3.36225 -4.29662\r\n-4.38925 -4.50946 -3.98569\r\n-2.18123 -1.97077 2.44632\r\n1.60426 -3.69947 -1.1431\r\n-1.52697 -4.5373 -3.38585\r\n3.53072 -4.93836 -1.51448\r\n4.9177 4.6301 -3.85272\r\n-0.85071 0.5148 -0.86463\r\n2.61539 4.29202 -4.29448\r\n0.09871 -3.18411 -0.27773\r\n2.56669 4.79346 4.50039\r\n4.3587 -1.1886 -4.97633\r\n2.66475 3.65085 -0.11211\r\n4.20566 -3.95582 4.56918\r\n1.249 -0.95214 -0.2449\r\n2.32823 4.37005 3.44904\r\n4.6925 2.54705 3.75555\r\n3.61548 3.7926 -1.61191\r\n-3.22083 -3.99752 -3.4866\r\n-0.48423 -4.04084 0.09792\r\n4.52225 -0.94634 -1.59136\r\n-0.29017 4.62006 4.64748\r\n-3.74937 -3.41839 1.59681\r\n-1.1129 -0.64189 -4.70902\r\n0.02658 3.49995 4.01607\r\n-3.25121 1.5398 1.69256\r\n2.40091 -3.30511 -2.88394\r\n1.80989 2.70075 -4.28558\r\n-3.00133 4.377 -1.95862\r\n-2.18072 -3.12214 0.5585\r\n3.10093 -4.04597 -1.06\r\n-1.54633 -1.08977 2.33662\r\n-3.86873 -0.22001 -4.19894\r\n1.35844 3.81446 2.19812\r\n-2.89942 0.92331 -1.67068\r\n0.57347 -4.22372 -3.48497\r\n4.08187 -3.81962 -1.4197\r\n-3.55233 -0.97097 2.39519\r\n2.26528 0.78117 -2.54844\r\n-3.55337 3.22481 -1.72975\r\n1.66542 1.99565 -2.46522\r\n2.79735 0.99777 -4.91815\r\n-3.15014 0.6169 3.81869\r\n1.30962 -1.84506 -1.9457\r\n1.52404 -0.51146 2.8831\r\n4.96871 3.20676 0.13386\r\n3.10899 3.35601 0.85867\r\n0.33812 -1.59033 -3.94681\r\n-4.29691 -1.6045 -2.57358\r\n4.49487 1.50618 -4.0588\r\n-0.20527 -4.03533 -4.95721\r\n0.02186 0.71235 -1.83815\r\n-2.79095 -3.09631 -1.92532\r\n4.18745 1.05066 -1.93206\r\n-2.09401 -2.33804 -1.42506\r\n-0.3152 3.72422 0.88231\r\n-2.95688 2.30232 1.20035\r\n1.44813 -1.47065 0.71307\r\n-2.60963 0.46944 -2.61536\r\n4.10171 4.96553 -3.39757\r\n1.94975 -2.57354 0.51449\r\n4.01856 -2.51104 3.84106\r\n-4.25955 -0.63995 3.50374\r\n1.6292 -0.69846 -2.62875\r\n-0.19799 -2.88853 1.79615\r\n-3.91083 -2.80255 2.64396\r\n4.74929 2.22073 2.02527\r\n0.02601 1.3638 -4.15481\r\n-4.05075 4.17595 -2.15203\r\n-1.21669 4.94455 1.38102\r\n-0.19586 -2.7169 -1.22993\r\n-4.35778 1.95051 1.43408\r\n0.28134 -0.10364 4.39412\r\n0.91523 3.54304 -2.6852\r\n-0.84548 0.28892 2.54622\r\n-3.09532 1.63964 -0.96492\r\n-1.09774 -3.03836 -0.58072\r\n-1.11083 3.03888 -3.91931\r\n2.03844 -4.09339 4.44897\r\n2.38172 -4.9721 1.07939\r\n-0.48413 0.28748 3.76726\r\n4.66597 -2.56972 -3.04917\r\n3.84723 4.25421 -0.6424\r\n-2.54878 -4.51157 -2.79102\r\n3.85385 0.67694 -1.0539\r\n-4.87907 1.85536 3.11244\r\n1.42715 -3.4293 -2.17215\r\n-2.92794 -4.7871 1.84181\r\n2.50139 -4.74228 -3.35628\r\n1.68217 -1.70122 -3.6761\r\n4.40446 0.49024 0.88201\r\n4.06467 4.72812 2.24841\r\n1.48766 -0.68054 -1.34113\r\n3.46902 -0.32965 1.5875\r\n2.26036 -3.03875 1.54487\r\n-1.24852 -2.49269 -4.1397\r\n3.85616 1.5511 4.35275\r\n-4.22708 3.25119 -2.66343\r\n3.99126 3.50555 0.02571\r\n-1.14183 1.21175 0.90664\r\n-4.5765 -1.40778 4.21268\r\n-4.97569 0.74926 -1.11035\r\n4.44125 3.80582 0.90885\r\n2.55043 0.44144 2.74155\r\n-2.49441 -0.39433 3.95375\r\n-2.17656 -0.48305 -2.35419\r\n-3.3478 4.52309 4.91813\r\n1.0764 -3.37233 0.11541\r\n-2.66054 3.76795 -4.89398\r\n-2.76014 0.54535 -4.41755\r\n4.40592 2.97718 -1.68791\r\n-4.27162 -2.93647 -1.12306\r\n-4.55613 0.40688 -0.21824\r\n3.27953 4.46436 0.58747\r\n-4.89612 0.75895 2.03972\r\n-1.89463 3.22747 4.40821\r\n-2.10118 1.0888 0.14624\r\n-3.9852 -3.02045 -2.6081\r\n3.87838 2.67857 2.6279\r\n3.41328 -4.8207 1.43494\r\n2.48541 0.16523 0.96707\r\n4.29611 4.99557 3.68633\r\n-4.33275 3.01128 1.97691\r\n-3.2413 -0.65331 3.27856\r\n-1.28424 -4.51308 4.94334\r\n-3.27868 -3.89169 2.81773\r\n1.73402 -2.72441 -1.56532\r\n-3.8544 -4.09672 -2.69479\r\n-2.1039 2.56525 -4.66305\r\n0.76856 -3.03175 2.39734\r\n0.7937 3.08175 -1.32842\r\n-3.58459 -4.76131 -1.9322\r\n4.33884 -2.00179 -2.29326\r\n-0.94103 2.61032 -1.83952\r\n2.29913 -2.37297 -2.44596\r\n-0.5589 4.18461 -0.07184\r\n-0.36322 -3.33951 -2.2409\r\n-2.91435 4.65001 2.80198\r\n0.20553 1.19167 2.86175\r\n-2.80182 3.9649 3.91255\r\n-3.93535 -4.00532 0.7344\r\n-4.47191 -2.18506 -3.4691\r\n0.24922 4.98791 -2.46072\r\n-0.65746 -4.06101 -2.8499\r\n4.82808 -4.615 1.28002\r\n3.21147 0.53468 -2.10011\r\n-2.18758 -3.94011 3.27246\r\n1.20419 1.44154 0.54957\r\n-3.35199 1.42811 3.23493\r\n3.24988 3.51607 3.52387\r\n4.85479 -4.2126 0.16861\r\n4.54785 -0.14576 2.14936\r\n4.47494 -2.80718 -1.28513\r\n2.9548 -4.48201 0.40348\r\n1.5396 -1.79628 3.5181\r\n2.28602 -4.03985 -2.25032\r\n1.02505 -1.8357 4.43474\r\n-0.19419 2.65189 -4.13274\r\n-1.99236 2.9173 -0.04802\r\n-1.84645 0.62598 -1.93638\r\n-1.40351 3.94837 0.58323\r\n-1.40108 0.2515 4.88303\r\n-2.93365 4.35 -0.18228\r\n0.29772 -3.20561 -3.15462\r\n2.2704 -3.76826 -0.22639\r\n0.50944 -0.67781 0.51275\r\n-0.63736 1.27388 1.90422\r\n-0.18668 -0.84916 -4.60521\r\n-0.43479 -1.28721 0.04965\r\n-1.29828 0.07585 1.55095\r\n1.02446 0.25008 -2.04678\r\n-4.04803 4.4767 4.06505\r\n-4.40611 4.14875 -4.86344\r\n3.59577 2.07043 -4.36116\r\n-4.19182 3.73287 2.86436\r\n3.32 -2.51512 -1.67623\r\n-3.78872 3.51575 3.95357\r\n-2.15197 1.64975 -2.22053\r\n2.67992 -4.87327 2.22434\r\n1.95126 1.24463 4.23282\r\n4.39016 1.60067 1.06791\r\n-3.07837 -4.97651 -1.06023\r\n-4.7725 -3.62738 -1.95576\r\n3.32306 -0.88498 -1.41314\r\n3.20437 -3.60728 -2.1666\r\n0.91119 -0.02701 -3.06333\r\n-2.29559 3.56836 -2.1641\r\n-2.08921 2.19907 4.19748\r\n2.74942 1.82734 -2.11864\r\n-2.74269 -2.26421 0.4053\r\n2.24396 -0.83855 -4.04017\r\n-4.30345 0.45853 -3.37093\r\n-2.66205 -2.71718 -0.53178\r\n1.62687 -3.53656 2.19115\r\n-2.71317 0.18404 -0.45659\r\n-0.773 -2.38962 1.12992\r\n4.00313 -1.83117 -1.0528\r\n-3.18254 -3.03365 -4.92289\r\n0.70781 4.74197 -0.56229\r\n-4.57904 0.4134 -4.61985\r\n-4.94535 0.76076 -2.61998\r\n0.95266 2.95748 3.87698\r\n1.53877 4.34016 1.38834\r\n-0.52207 -4.22706 1.18725\r\n3.43589 2.38661 0.32425\r\n-2.37461 -3.84287 2.04241\r\n-1.14159 -1.82211 -2.99677\r\n-4.84573 2.17935 0.35278\r\n4.47374 -3.93322 2.83733\r\n-0.9884 3.53941 -2.73045\r\n1.33817 -4.68605 -2.67451\r\n0.34714 4.53211 2.49721\r\n-4.51199 4.34256 -1.13235\r\n2.91342 -0.11735 -4.74483\r\n4.33169 2.72613 1.10805\r\n-0.71624 0.05514 -4.05226\r\n3.65535 -3.09277 2.73069\r\n0.04884 3.43563 -2.07853\r\n4.27128 -2.92896 0.88818\r\n-0.57619 -3.58615 2.9227\r\n-2.64444 -3.32675 -2.87163\r\n1.86047 3.0495 -1.00388\r\n4.78984 -0.25042 -0.77423\r\n-2.32465 1.29668 3.60859\r\n-1.34672 0.25539 0.02502\r\n0.56703 0.58333 0.6377\r\n-2.17281 4.96219 -0.30277\r\n1.389 -1.72266 -0.95956\r\n-1.26163 3.9396 -1.47062\r\n-4.14716 1.59669 -0.25\r\n-2.97296 3.42484 1.51336\r\n-4.28869 -1.47757 0.61784\r\n3.07208 -1.50539 3.32656\r\n-3.53711 -3.01957 -3.65062\r\n-2.71818 -3.08487 3.63302\r\n-3.52185 0.85303 2.34746\r\n-2.63384 1.62722 2.50756\r\n-2.19771 -0.52692 0.24953\r\n-1.21201 1.57292 -1.58763\r\n4.40284 1.46151 -3.03362\r\n3.67291 -3.89758 -4.34176\r\n-1.68536 -4.15235 1.20149\r\n-2.44907 -3.23187 -3.8962\r\n-2.98742 3.06784 0.39008\r\n-0.23123 -4.65677 2.51465\r\n-0.00974 2.64041 1.46029\r\n2.30777 2.67272 0.37457\r\n-2.49764 -3.92529 -0.5942\r\n-4.89444 -2.09292 1.31986\r\n2.19326 2.30511 2.10475\r\n-0.84125 -2.97746 -4.99063\r\n-2.28374 -4.13938 -4.19087\r\n-1.43699 -2.59742 4.15704\r\n-2.84407 3.27367 -0.70354\r\n0.78485 -0.15389 1.53861\r\n3.73791 -4.12559 -0.24618\r\n3.7567 -2.1699 0.0155\r\n0.32939 0.03391 -4.33501\r\n2.02182 4.98344 -1.93634\r\n-4.80628 4.75852 -2.82188\r\n-2.92801 3.5511 2.6596\r\n1.35928 2.69885 2.8785\r\n1.38427 -0.9548 1.52202\r\n2.90759 -0.11598 -0.93865\r\n-3.77364 -1.17599 -1.57087\r\n1.62344 4.09801 4.33371\r\n2.63117 -3.03605 -1.12113\r\n-0.89722 -3.79073 -1.32431\r\n0.59065 2.48273 -2.58205\r\n-3.6267 4.79911 -2.9047\r\n-4.29632 -2.86325 3.68572\r\n4.00462 4.05991 4.13028\r\n3.63348 3.31345 -4.11392\r\n-2.32009 -3.75764 4.57163\r\n-3.23359 -1.01193 -4.50356\r\n1.82233 2.8265 4.49679\r\n-1.96386 -4.75328 2.44196\r\n3.40068 -1.22203 2.16558\r\n-1.20788 -1.88011 2.87727\r\n-0.73147 -1.24484 -1.27337\r\n-0.81004 -4.92466 -4.22304\r\n2.10847 -2.94506 3.62672\r\n-1.381 2.07811 -3.8844\r\n3.19231 -1.09599 -4.50313\r\n4.64358 3.61825 -4.69016\r\n-0.39243 -3.34358 3.9712\r\n-3.42519 4.77302 0.95989\r\n4.97906 -0.57324 0.29572\r\n-1.6427 -2.53918 -2.34283\r\n-3.94756 0.89939 1.28162\r\n-2.81651 1.08204 0.91068\r\n2.09542 4.47342 0.21177\r\n-0.16204 -4.92212 -3.39825\r\n0.40642 -0.86064 -2.49979\r\n3.9853 1.75956 3.31116\r\n4.00417 4.22059 -2.66921\r\n-2.62489 2.07066 -3.16253\r\n-1.65929 -3.41374 -4.55992\r\n4.8807 -4.28632 -3.1145\r\n-3.42368 -2.27673 -1.95159\r\n-2.02487 1.21198 -3.24651\r\n4.08755 3.56134 2.03373\r\n-1.09336 2.23998 3.7397\r\n2.46328 3.64202 4.69799\r\n-4.99448 0.10453 3.18405\r\n1.16918 -0.82694 3.89183\r\n0.57889 -2.29708 0.25681\r\n-4.76138 -2.48014 0.39105\r\n-0.31857 3.95771 3.05585\r\n-4.81524 2.96528 4.7326\r\n2.29765 1.72323 -0.35465\r\n-0.04628 -4.42913 -1.69233\r\n-1.33202 -0.63932 -0.40741\r\n0.0792 0.60714 -3.34186\r\n-2.82744 -2.84021 2.54405\r\n2.44517 -0.41917 0.12352\r\n-3.4983 -1.10009 1.27816\r\n-1.72651 -4.58223 -1.09095\r\n3.10758 -4.35257 4.61694\r\n2.44422 -1.63085 0.23903\r\n-0.67963 1.28343 3.61261\r\n3.19134 2.83173 -1.86198\r\n-4.43104 -4.98005 0.34076\r\n3.50515 -0.41916 -2.63168\r\n1.67436 -2.07449 1.4529\r\n3.18078 -2.78971 -4.01026\r\n2.80531 -2.03083 -3.39439\r\n-0.22474 -2.45382 -4.02297\r\n4.65754 -1.19689 -0.49684\r\n1.94765 0.03409 1.90656\r\n1.18619 2.66249 0.6064\r\n-1.41747 -1.56946 4.48551\r\n0.9303 3.83934 3.1331\r\n-1.47379 -4.00285 -0.27372\r\n3.30257 -3.89705 -3.16635\r\n-1.40112 2.24335 1.00358\r\n-4.28643 -0.10698 0.94263\r\n0.70553 2.17251 -4.74414\r\n1.32813 0.44448 4.52238\r\n-2.50473 4.84181 -3.54745\r\n2.09895 -1.31471 2.43928\r\n1.59886 4.87062 -3.84733\r\n-1.74873 -1.18284 -1.52095\r\n-1.04887 1.53165 -0.40428\r\n-0.65612 -1.88638 -4.85585\r\n1.29628 -2.50558 -2.78278\r\n-2.04284 -1.5607 -2.521\r\n4.74074 3.60026 -0.88873\r\n-0.0718 2.15185 3.41646\r\n2.75014 -0.69735 2.78087\r\n3.15566 3.99065 2.49119\r\n-3.78481 -2.34557 1.38477\r\n4.27027 0.71767 3.61358\r\n-3.27127 1.73336 -2.27208\r\n-3.94568 2.37637 4.32741\r\n2.66333 1.58881 0.60087\r\n-3.95907 -4.54084 1.88559\r\n-1.45527 -1.31544 0.4493\r\n-2.00757 -2.14324 -3.44347\r\n4.00907 4.1629 3.098\r\n2.43278 -1.66826 -1.47284\r\n1.91829 1.95889 -1.4721\r\n0.67436 -4.47764 3.12386\r\n3.66026 2.75352 4.72712\r\n-0.57022 -4.72009 -0.70188\r\n-2.22445 2.72722 2.19053\r\n1.74047 -3.8965 3.11598\r\n-4.67893 2.08389 -3.48082\r\n-2.78955 -2.22857 -4.15291\r\n-1.91257 4.48687 3.28896\r\n-3.81935 -0.21506 -0.43169\r\n1.80963 -3.36708 -4.50862\r\n0.92776 -2.54631 -3.76338\r\n2.28111 -1.03297 -0.63373\r\n-0.95118 0.8517 -2.42771\r\n1.81144 -2.39462 2.56716\r\n3.68675 -1.81998 1.378\r\n-2.97998 -0.20319 -3.49402\r\n-0.33762 1.94221 4.49926\r\n0.02243 -1.73582 0.94068\r\n-3.73386 0.65928 -4.95373\r\n0.87109 -2.55631 -0.73526\r\n-4.7338 -3.36981 1.00724\r\n3.62441 3.39321 -2.90302\r\n2.77993 2.17612 4.57728\r\n0.18445 0.19961 2.39427\r\n-0.10056 3.44639 -3.32838\r\n4.17276 2.60018 -0.45377\r\n0.89762 -4.63241 2.05357\r\n-4.94949 -0.70303 -4.03984\r\n-2.09932 -2.39286 4.97478\r\n-4.21187 -4.71227 -0.79093\r\n-3.61728 1.62919 0.62914\r\n3.58967 -2.9431 -0.6544\r\n-1.81788 -0.2387 -1.21228\r\n-4.91312 0.43797 4.20458\r\n-4.73634 -2.50752 -1.96342\r\n-3.99973 -0.0087 2.81081\r\n4.32505 -2.49062 2.00836\r\n2.64973 1.2083 -1.29296\r\n4.89441 3.81185 -2.31407\r\n0.57044 4.18261 0.23494\r\n3.73923 2.2255 -1.33949\r\n-4.92037 4.0801 2.0717\r\n3.44596 1.08978 -3.94016\r\n0.76627 1.79288 1.39463\r\n1.23978 -4.90841 0.63371\r\n1.74056 1.67347 -4.80201\r\n2.51414 -1.15651 -3.02481\r\n-0.29362 -0.75274 1.6264\r\n4.55369 -3.07881 -0.18287\r\n-4.72854 1.0967 0.54963\r\n3.37914 3.23102 -0.83584\r\n2.46854 -0.85625 -1.96563\r\n-1.91424 -0.07873 -4.10736\r\n2.54611 -2.5869 -0.22906\r\n-0.84349 -2.87665 -3.104\r\n-1.15501 1.83417 -2.74544\r\n-1.97072 3.40474 3.07882\r\n3.54638 -4.10352 2.42104\r\n1.19682 1.73129 -3.84236\r\n0.93442 0.88362 -4.3905\r\n-0.47809 -3.70119 -3.81701\r\n-0.5453 -0.08918 -2.79577\r\n4.31849 2.58862 -3.73321\r\n-4.64808 3.4257 1.09592\r\n-1.87488 3.01958 -1.35002\r\n3.68821 1.21161 0.49125\r\n1.02787 -0.57377 4.88886\r\n-0.03016 -1.90745 -2.95023\r\n-2.55202 -1.24175 -3.61047\r\n-2.02012 2.33641 3.20954\r\n-1.16211 -4.64711 3.155\r\n3.16286 3.04652 1.85879\r\n-0.21438 -0.34779 -0.47431\r\n0.03101 -3.15403 0.84154\r\n-1.05387 -2.84991 2.4094\r\n2.13941 2.98886 1.36813\r\n-4.30959 2.33921 -2.22866\r\n1.45823 3.64943 -4.75036\r\n3.8364 -2.03486 -3.57265\r\n-1.18402 -3.31443 0.6786\r\n0.32641 2.82755 -0.12038\r\n-4.89153 -1.3556 3.18812\r\n3.61761 -1.91375 4.77713\r\n-1.00799 -4.91465 0.3709\r\n4.24248 -4.78246 -2.31379\r\n-1.99568 -1.26597 3.76539\r\n-2.32533 0.70215 4.49489\r\n4.42318 1.37874 2.32215\r\n-1.35438 -3.86895 2.13762\r\n-4.85369 2.46567 -0.67921\r\n3.68762 0.34774 2.62406\r\n2.72284 3.07098 -3.54017\r\n0.07103 3.72389 -0.76056\r\n-3.96087 1.35711 -4.12059\r\n0.70276 -0.83089 2.40327\r\n-3.84077 2.34367 -4.63011\r\n4.57792 -1.54643 0.47977\r\n-1.09226 3.33109 3.70564\r\n4.72896 -3.69886 -4.6485\r\n1.13144 1.99977 4.31675\r\n-0.59005 -1.86604 3.80812\r\n-2.57594 4.00988 0.71382\r\n-1.98656 1.55542 1.5973\r\n0.19235 -0.58242 -3.49261\r\n2.90951 2.45867 3.33796\r\n-3.59614 -0.8248 4.28245\r\n2.76187 -4.09231 1.39934\r\n1.7684 3.79649 -2.04992\r\n0.8448 4.43779 -1.70078\r\n1.44757 2.72696 -3.14372\r\n1.40841 1.01911 -0.97929\r\n-2.7459 -4.23517 -1.73976\r\n0.18612 -1.10209 4.46447\r\n2.03898 -3.72144 0.75155\r\n4.76011 1.46119 -0.46061\r\n-1.85521 -3.05178 2.99266\r\n1.37992 0.68518 2.58159\r\n0.34813 -4.18649 -0.66087\r\n-0.82932 1.31748 -3.54218\r\n-3.48347 4.0688 -4.11588\r\n-0.33787 2.19867 -3.12915\r\n3.19834 -1.36192 -0.56192\r\n-0.3449 -1.85023 1.9441\r\n-2.00535 3.12739 0.95974\r\n-3.16634 -4.63402 -0.06531\r\n2.43656 3.19896 2.64237\r\n-0.51765 -2.45228 0.06311\r\n-0.71212 2.92767 0.27351\r\n-3.06476 1.09404 -3.51164\r\n4.24621 4.93624 0.60055\r\n-0.82488 1.60506 -4.63151\r\n-1.82243 4.37183 -2.76043\r\n3.08028 -4.95844 -2.50159\r\n-1.78707 0.99161 2.72158\r\n2.887 0.77736 -0.25881\r\n-0.89498 4.80053 -2.59952\r\n0.40747 -1.64712 3.58951\r\n-1.61133 -4.28732 -2.08961\r\n-4.36696 -0.60971 -2.88959\r\n-4.87063 -3.98537 -1.01682\r\n-3.00821 2.8673 4.08569\r\n-3.8034 3.76356 0.46004\r\n2.44004 -0.90093 1.43673\r\n-0.33755 0.74076 0.05836\r\n0.17378 2.94311 4.8886\r\n0.83226 -0.10734 -0.73374\r\n-4.87622 -4.74312 2.34372\r\n-2.61786 -0.88389 -0.91244\r\n2.14878 1.03977 -3.94224\r\n2.01746 -2.66177 -3.5118\r\n3.48031 1.66751 -0.50415\r\n4.68752 0.42117 -3.75927\r\n4.09761 0.9698 -4.79753\r\n-4.87818 -2.19182 -0.63253\r\n2.77619 3.94438 -2.33586\r\n-1.80422 4.75795 -4.56565\r\n-3.89882 0.48591 -2.36782\r\n-3.06304 3.04533 -4.17576\r\n3.07584 -2.53258 3.28107\r\n-1.86776 0.93868 -0.90325\r\n-1.89994 -4.77329 4.07539\r\n-3.31087 -3.52967 0.17101\r\n-3.59431 0.74263 0.13234\r\n-0.80055 -0.59692 4.33414\r\n1.22924 3.49079 -0.44067\r\n-0.72703 4.24048 -3.65014\r\n-4.15133 1.45198 -2.89345\r\n-1.70907 -3.5209 -3.28467\r\n0.88813 -2.70068 3.56004\r\n3.53057 0.22453 0.39985\r\n1.08798 -0.75826 -3.91779\r\n2.96418 -3.20275 4.16627\r\n3.52604 -0.94926 0.55777\r\n-2.68871 1.93433 0.19946\r\n2.22767 -0.70664 3.65368\r\n4.38351 -0.00708 -1.73139\r\n4.78556 2.65735 -2.6962\r\n1.80448 -2.77077 4.51612\r\n4.81252 -1.34875 -3.30106\r\n0.45871 4.92368 -4.35161\r\n-1.64462 0.14267 3.41486\r\n-0.14307 2.41803 -1.05671\r\n-4.85497 4.1847 3.50813\r\n-3.09213 -0.47993 -1.8174\r\n-0.27577 -1.22334 2.73048\r\n3.95248 0.4858 -2.90123\r\n-0.99042 -0.21479 -1.8487\r\n1.63898 3.68641 -3.65922\r\n-4.69904 -4.68183 -1.76512\r\n3.75914 -3.91223 3.62816\r\n-3.33941 -4.79413 -4.10738\r\n1.97883 -1.43912 4.60371\r\n-1.36652 -3.88768 3.91194\r\n2.49989 0.96949 1.78589\r\n-1.92813 3.88836 -0.21576\r\n0.40947 0.99553 4.09736\r\n-3.92459 2.6931 0.91797\r\n4.76664 -3.33356 3.70974\r\n0.90699 0.18034 3.61005\r\n-4.22668 2.68252 3.21378\r\n3.27014 -0.13016 3.4627\r\n1.55838 -4.8564 3.62809\r\n3.24769 4.98746 3.13846\r\n4.93293 1.53188 4.08915\r\n2.58115 -3.53153 2.58296\r\n0.05165 -3.92356 1.99326\r\n-3.68518 -1.09395 -3.56704\r\n-0.24767 4.49846 -1.62132\r\n0.0663 4.82833 1.53417\r\n-3.99242 -2.45958 4.64699\r\n-2.03394 0.43143 0.88471\r\n-4.52808 3.21633 -1.58126\r\n1.17921 1.40236 3.3116\r\n-1.92797 -3.47076 -1.41055\r\n1.30297 -0.15239 0.6489\r\n2.12679 0.38336 -1.66166\r\n0.43537 -2.6661 -2.13538\r\n-0.00232 2.11244 2.26693\r\n2.74105 4.76496 -0.77423\r\n3.48244 0.71044 1.46521\r\n4.41941 4.45558 -1.54961\r\n-4.65991 -3.32341 2.12398\r\n-1.82615 -2.64424 1.58758\r\n0.65175 1.97823 -1.50438\r\n-1.09558 1.75823 2.82438\r\n0.07912 -4.86678 0.15955\r\n-1.48963 0.32323 -3.13486\r\n2.40572 4.17503 1.81913\r\n0.755 4.34492 -3.54921\r\n3.56495 2.08855 1.56523\r\n-1.04249 2.67102 -0.72662\r\n-2.03324 4.77704 -1.87205\r\n0.66804 4.06315 4.63254\r\n0.09492 -0.33707 -1.5525\r\n-1.5152 -2.37083 0.31558\r\n-3.78092 -3.69772 -4.47714\r\n1.01693 -1.54462 -2.92572\r\n-0.69858 -1.01668 -2.39776\r\n-1.30977 4.51123 -0.60517\r\n3.13362 1.13177 -2.92277\r\n2.76864 -4.17182 3.40856\r\n-3.6304 4.27964 1.89555\r\n3.24382 -4.89628 -4.08658\r\n-3.21037 -1.9201 2.75056\r\n4.06267 -1.82907 3.01813\r\n4.41495 -3.69934 1.84755\r\n-1.18872 -1.3305 1.43949\r\n3.01297 -2.23556 2.16766\r\n1.89131 0.0063 -3.50102\r\n1.56829 0.73529 1.26375\r\n-1.63765 3.62212 -4.60794\r\n-0.06092 -2.43515 4.39785\r\n-4.27472 4.00369 -3.40895\r\n-3.14162 -4.74574 3.83804\r\n-2.78835 -2.05451 1.58447\r\n0.28607 4.57959 3.62818\r\n1.16022 -4.61596 -1.48649\r\n0.70058 -1.90511 2.30301\r\n0.32383 1.43685 -2.8813\r\n-4.9778 -2.48656 2.77279\r\n2.62536 -2.19941 -4.6483\r\n3.22003 4.29869 -3.35673\r\n-3.77313 2.57649 -3.44556\r\n-0.31198 -2.37173 2.90794\r\n4.81432 1.88128 -1.7755\r\n-0.61108 -2.18408 -2.02127\r\n-3.53818 4.10437 -1.00788\r\n-3.45697 -3.77357 4.23602\r\n2.75462 -3.38902 -4.80662\r\n-2.67246 2.56205 -2.03617\r\n-3.49254 -0.10159 1.83959\r\n0.24429 -1.55581 -1.68031\r\n1.08512 1.84359 2.37604\r\n3.10979 -0.87116 4.43758\r\n0.62789 -4.70885 4.39583\r\n2.25655 1.90545 -3.35023\r\n3.79981 -0.43072 -0.343\r\n-4.32444 -3.3234 -0.25525\r\n0.10591 3.94004 -4.49742\r\n-4.57474 -4.28575 3.4853\r\n-3.74652 0.69389 -0.93463\r\n3.4145 -3.20396 1.58947\r\n3.96658 4.33094 -4.29207\r\n1.91233 0.70014 0.22046\r\n4.55603 2.15698 4.93575\r\n1.41126 -4.49714 -0.36052\r\n-4.65649 -3.12823 -3.88848\r\n1.79843 1.81122 1.3174\r\n-2.32665 -0.43958 1.55305\r\n2.13985 0.35809 3.72396\r\n3.47307 4.12627 1.5086\r\n-3.09816 -2.20024 -2.97403\r\n3.73385 4.74602 4.86066\r\n0.63973 1.07541 -0.29225\r\n0.09354 -1.79425 -0.58987\r\n-1.12556 4.45917 2.62197\r\n-2.21529 2.01682 -0.78261\r\n-4.11611 -4.7289 -4.92569\r\n4.73942 3.71894 -3.48179\r\n-3.90216 2.21623 -1.32244\r\n0.28001 3.09193 2.77523\r\n-4.25298 -1.24 -0.40414\r\n1.66701 -4.373 1.63722\r\n-4.6194 -1.48341 -4.75923\r\n4.02596 -0.12262 -4.2736\r\n3.02574 1.03652 3.73698\r\n3.31061 -1.65048 -2.56699\r\n-1.05851 2.88108 2.83275\r\n3.16947 0.08285 -3.66696\r\n-2.77693 0.20712 2.91553\r\n0.44134 -3.84392 -2.48811\r\n-3.04204 -0.14734 4.83866\r\n1.20054 -4.16797 -4.72794\r\n4.25031 -3.41374 -2.56697\r\n1.35115 0.97152 -3.07644\r\n0.60492 -3.71009 3.78569\r\n0.60944 -2.3143 -4.65667\r\n3.40974 -2.90354 -2.95963\r\n4.55511 -0.44451 -2.69264\r\n2.38596 2.93178 -2.43456\r\n-2.34772 4.35174 1.73138\r\n-3.22599 -0.38595 0.53997\r\n-0.25845 -4.44695 3.5729\r\n-3.61699 3.30068 4.91415\r\n4.74163 -1.517 2.15897\r\n1.91955 0.12114 -0.63556\r\n-4.72828 -2.46426 -4.69153\r\n1.01891 1.28272 -2.06978\r\n-3.4037 -1.943 -0.90062\r\n-2.31554 1.50656 -4.86394\r\n4.16432 -0.35949 4.14464\r\n2.17339 -0.21477 4.5526\r\n-0.05577 -0.51654 3.44475\r\n3.89413 -4.06536 0.93854\r\n-2.73872 -4.11303 1.05735\r\n2.4602 -3.68992 -3.73809\r\n-0.43716 0.54241 1.18279\r\n-2.28087 4.95265 0.91948\r\n3.31544 2.12845 -3.40411\r\n-1.24286 2.29858 2.02909\r\n4.34534 -4.71293 -4.3761\r\n-4.49423 -3.56619 4.63879\r\n1.9123 2.15255 3.65484\r\n-2.78871 -3.11589 1.31671\r\n4.40504 -4.84991 -0.62446\r\n-0.38751 0.48234 -4.95971\r\n1.52987 4.71307 2.75114\r\n-1.2338 1.34281 4.42784\r\n1.67278 0.08815 -4.60785\r\n3.13407 -3.42223 0.47488\r\n0.79965 3.03439 -3.86692\r\n-0.82047 3.60892 4.81272\r\n-4.61229 1.4739 -4.88108\r\n3.05362 -2.41729 0.94786\r\n0.68173 -4.05168 0.80936\r\n-1.03467 2.58732 -4.99077\r\n-4.25078 3.23246 -4.22242\r\n-2.93219 1.93016 -4.13579\r\n-3.89168 1.8554 2.51019\r\n4.51728 0.61628 -0.10467\r\n2.79728 2.37874 -0.98691\r\n-3.10466 2.46449 3.04792\r\n3.17584 1.66529 2.52776\r\n3.49746 0.37549 4.3934";
        foreach (var line in pozycje.Split('\n')){
                string[] temppos=line.ToString().Split(' ');
                Particle tempparticle = new Particle();
                tempparticle.pos.x = double.Parse(temppos[0]);
                tempparticle.pos.y = double.Parse(temppos[1]);
                tempparticle.pos.z = double.Parse(temppos[2]);
                particles.Add(tempparticle);
            }    


        }
        public void Ref3() {
            particles.Clear();
            string pozycje = "-0.68646 -4.39029 -3.40384\r\n-1.28124 4.52873 -2.17337\r\n-1.80448 -0.30829 -1.13108\r\n-1.52896 2.45893 -0.77805\r\n-4.05567 -1.41663 -2.47966\r\n-3.06383 2.65654 -0.99765\r\n-2.05107 0.78644 -0.79756\r\n-1.40781 3.22965 -3.23298\r\n-0.72916 1.71821 -2.42448\r\n-4.79563 3.25342 3.67386\r\n-4.31453 2.81515 4.6488\r\n-1.66492 3.37631 -0.37609\r\n-0.56966 3.45211 -1.22019\r\n-3.45491 -3.97645 -1.55877\r\n4.39426 1.30006 1.83922\r\n-4.3929 2.20444 0.55601\r\n-2.40893 2.77186 -3.72135\r\n-3.00273 -4.92363 -3.58573\r\n4.07836 2.63112 1.39799\r\n3.95212 4.51716 4.57733\r\n1.27218 -3.12678 -1.36651\r\n-3.48387 -2.68938 -0.7806\r\n1.4701 4.38668 -0.58946\r\n-3.03239 2.40779 -2.1178\r\n4.58218 -2.76436 -3.84092\r\n0.82824 -2.92481 -3.48776\r\n2.75925 -1.80226 -3.83802\r\n-2.00368 -4.71165 -2.32474\r\n3.35965 -2.8468 -2.69172\r\n1.10486 -1.68968 -3.20819\r\n-0.18849 -2.59296 -3.61164\r\n-3.20239 1.74196 1.09217\r\n-1.75543 4.61017 -3.19868\r\n-1.42956 3.53396 -4.25858\r\n3.50041 4.48823 1.28393\r\n0.66883 -2.74913 -2.48797\r\n0.24598 -2.29722 1.9346\r\n-2.54806 -2.91222 -1.55842\r\n-3.0164 0.52474 1.05691\r\n-3.91481 0.68227 0.12738\r\n-2.46139 1.85196 -0.36106\r\n4.79174 -3.57552 -3.07351\r\n-4.99883 0.89573 -0.18125\r\n3.13372 3.36424 1.70738\r\n-3.64754 -0.61521 3.4831\r\n1.93775 4.9073 -1.52111\r\n3.84065 -4.07154 -2.46182\r\n3.39614 3.52799 4.67479\r\n-2.3135 1.06103 -4.03251\r\n-2.1099 -2.31262 -2.64875\r\n4.58278 4.64231 1.42949\r\n1.19288 -4.15949 -1.41927\r\n3.98644 1.56565 0.93936\r\n-4.04417 2.95908 -0.89878\r\n-4.39245 -2.88515 -2.81549\r\n-4.74018 1.96688 3.71272\r\n-0.28107 -1.71803 -2.36479\r\n4.65221 -1.63262 -2.04621\r\n-2.4625 -1.53863 -1.77522\r\n1.34892 -3.4797 -2.38816\r\n-3.52712 -1.89621 -1.47551\r\n0.07336 -4.24626 -4.05987\r\n4.2346 3.65794 1.67189\r\n-1.51389 1.54767 -3.21031\r\n-2.28917 3.22141 -1.36369\r\n-1.5605 -3.64797 -2.68018\r\n-4.37583 -0.90269 -3.73826\r\n0.24629 3.75907 -4.61156\r\n-4.41928 -2.18317 -1.99913\r\n-0.67805 -3.77453 -2.1863\r\n-0.17217 1.5236 -3.6989\r\n-1.23957 1.77833 0.10852\r\n0.00481 -3.73487 2.89148\r\n0.53305 -4.18188 -2.29187\r\n1.70943 3.92231 -1.38186\r\n0.6024 2.7251 0.11515\r\n4.57021 -2.62639 -2.71369\r\n-4.78937 -0.9628 -1.55283\r\n4.35846 3.84304 3.59265\r\n-0.77498 2.5083 -3.55215\r\n2.83843 3.16381 2.78359\r\n-3.34332 2.20364 0.14101\r\n0.41916 3.51447 -3.40866\r\n2.28187 4.42629 -3.63586\r\n-4.36963 1.7956 -0.52089\r\n1.20157 4.23326 -2.86143\r\n1.78313 -1.05855 -2.31825\r\n-2.33265 1.77238 -1.4092\r\n3.51661 3.26122 -0.05659\r\n3.83609 3.00417 2.43741\r\n-0.58533 4.30457 -3.12421\r\n4.3757 1.99317 2.99288\r\n-4.50847 3.84614 -4.5116\r\n-1.19053 4.81467 -4.13764\r\n-0.44435 3.16659 -2.8304\r\n2.12403 -4.22991 -2.0873\r\n-1.59776 -1.48309 0.18463\r\n-1.44457 -2.70067 -1.7485\r\n3.18428 1.96282 2.18205\r\n1.7153 -1.37512 -0.44066\r\n-0.11412 4.92673 -4.89073\r\n1.10948 -4.63594 -3.2997\r\n2.74191 4.35984 4.86011\r\n4.85866 3.29778 0.98909\r\n-2.16407 -1.16443 -0.68777\r\n-3.66919 3.26266 0.16887\r\n2.01869 4.88941 -4.47121\r\n-4.52756 4.90763 -0.78171\r\n2.34287 -0.5659 0.18473\r\n3.67573 4.72862 2.59598\r\n3.89994 4.79906 -3.35861\r\n2.41755 1.59051 2.68962\r\n0.00943 -0.81209 -3.98219\r\n4.71189 3.36242 4.88145\r\n4.08688 -3.95437 -1.26345\r\n-4.16794 -0.74374 -0.28714\r\n-4.73798 -3.85861 -0.98671\r\n1.52421 -2.27964 0.76176\r\n2.52352 -2.88988 -2.0897\r\n3.02775 -3.25765 -1.05513\r\n0.50335 -1.94622 -4.11512\r\n0.30595 2.68493 -1.82673\r\n-2.54123 1.78143 -3.28844\r\n3.0628 -3.86766 -0.04191\r\n0.91115 2.12564 -1.10056\r\n-4.80239 1.26835 0.95291\r\n-3.93166 -1.1432 4.96156\r\n-2.73055 -3.65172 -2.76111\r\n-3.14399 1.31387 -0.9088\r\n4.91939 3.78663 -3.53512\r\n-1.15225 -3.82265 -1.0426\r\n4.33255 2.31719 4.02565\r\n-3.85663 0.00424 2.54519\r\n1.94825 -3.49405 -0.56477\r\n-0.92429 -4.40831 -4.68473\r\n-0.8295 -2.95023 -2.8495\r\n-0.95003 -3.17721 -3.7841\r\n2.3042 -4.40379 -3.54095\r\n-4.84985 -1.826 -3.19598\r\n-2.37746 0.75 0.28387\r\n-2.1696 -3.85248 -1.78603\r\n0.41204 1.41854 2.63601\r\n-4.78829 3.88978 0.2025\r\n-4.07617 -2.73766 4.62865\r\n-1.37926 0.60145 -3.69808\r\n3.58277 -2.12356 -0.1044\r\n-2.95995 1.83265 -4.60337\r\n-4.15617 1.52873 1.72966\r\n-3.18205 4.20144 0.11278\r\n4.95931 -0.53063 4.26067\r\n3.13071 0.3876 -0.10612\r\n3.75253 -3.63824 -3.59565\r\n3.09001 -4.4601 -1.87292\r\n-1.19547 2.40533 4.62112\r\n-2.43357 -1.13274 0.91032\r\n4.93661 -0.38 -4.65172\r\n2.84878 -1.28098 -2.52013\r\n-2.67196 3.21605 -0.14291\r\n-3.11875 -0.62468 -4.71959\r\n2.26217 2.94406 3.71354\r\n-2.24683 -4.82387 -1.01987\r\n0.84173 -1.51414 -2.10777\r\n4.15745 -2.56475 -1.57279\r\n-0.01704 -3.9078 4.0032\r\n-3.74915 -4.11106 -0.10509\r\n-2.1244 -0.27892 -3.50368\r\n-1.0424 -3.29218 3.61799\r\n0.91402 -4.54033 3.77116\r\n1.226 -1.66911 -4.89431\r\n-2.97437 -4.91706 -0.35101\r\n-1.54674 -3.9275 4.32632\r\n1.22959 -3.41982 3.00753\r\n-1.21493 0.20463 3.63587\r\n4.57126 1.45472 -1.21629\r\n-0.91628 -1.65854 -1.53218\r\n-0.69315 2.49637 -1.71244\r\n4.09 3.86947 -4.53453\r\n-3.70194 -2.26139 -3.16666\r\n-2.1747 -3.75488 -0.76842\r\n-3.59241 -3.07244 -1.99277\r\n0.87674 -4.78262 -4.7315\r\n-1.85538 1.96992 -4.1299\r\n1.04766 -3.25582 1.92971\r\n2.93596 -2.20387 1.04751\r\n-4.05538 4.72452 0.14411\r\n1.68784 -2.28177 -3.97909\r\n3.24986 -2.05751 -1.18212\r\n-0.61364 3.52365 4.90077\r\n-4.37753 -3.14515 0.13988\r\n4.97991 -3.33612 -1.9612\r\n1.79873 3.71545 4.97251\r\n-4.94528 -1.41451 4.7527\r\n-0.37642 -2.69584 -1.72378\r\n-2.03054 3.40516 0.76157\r\n-3.6099 4.22469 -0.91452\r\n2.12649 2.85335 -4.43259\r\n-1.23959 1.23297 -1.35554\r\n-2.14986 -2.69586 0.42009\r\n2.49645 -3.23953 -3.32146\r\n1.62418 -2.49944 -2.75334\r\n0.08035 -1.34725 -4.97167\r\n4.27037 0.06214 -3.8908\r\n-4.96481 -4.37617 0.26173\r\n-4.91417 4.21567 4.39128\r\n-1.63256 4.0251 1.48605\r\n-1.85604 1.06494 1.96797\r\n0.23691 4.22399 -2.54279\r\n1.87567 2.54697 2.58013\r\n0.11811 1.05924 -0.98749\r\n2.12862 -1.42844 1.18591\r\n0.18363 -3.81816 -1.28413\r\n0.95077 3.26922 -2.34911\r\n0.16209 2.59312 -3.94956\r\n-1.17885 4.97951 -1.13143\r\n1.88588 0.64703 2.70252\r\n-2.73326 -3.89135 3.66533\r\n-4.43429 -2.09825 -4.46104\r\n2.8881 3.9395 -1.73654\r\n4.7042 -1.40343 -4.04619\r\n3.96931 -1.15224 4.49211\r\n3.39672 4.10652 -0.71403\r\n-4.42621 0.85297 -1.15608\r\n-4.97657 -4.6168 -1.91772\r\n-1.61213 -2.46436 4.78421\r\n1.82273 -2.54041 4.79683\r\n-1.9153 -2.3275 -0.59662\r\n-4.69818 -2.33146 -0.69776\r\n-4.51317 0.39475 1.42492\r\n2.44459 3.61328 -0.26132\r\n3.21091 -0.87834 -0.67754\r\n-1.25796 -3.53821 0.12327\r\n2.2968 -2.39872 -0.69613\r\n-2.96299 -3.26786 -4.52984\r\n3.8315 -2.0173 -3.73854\r\n-4.13445 -0.1286 -4.3199\r\n-0.21596 2.36129 -0.60888\r\n2.92934 2.34873 -1.73785\r\n-0.67726 1.54476 4.00928\r\n-4.4969 -3.12161 -4.15016\r\n4.39482 1.02566 4.56972\r\n-0.75223 0.18428 -0.85431\r\n-4.89967 4.83386 -4.64286\r\n-0.57722 0.49417 -2.52146\r\n-0.7516 4.55737 2.05181\r\n1.07055 2.62499 3.25894\r\n0.77393 -0.00775 -1.0265\r\n0.91139 1.14569 1.51251\r\n0.66783 2.01411 0.88188\r\n1.64447 2.9822 0.25241\r\n-2.18381 -4.91994 0.66356\r\n1.4291 4.36012 4.41394\r\n-2.54403 2.56016 1.46165\r\n-1.08483 -0.96804 -2.98006\r\n4.45961 -3.58663 3.41318\r\n1.01474 2.06147 2.10196\r\n-4.27873 -4.23793 2.7218\r\n2.21791 3.64574 -2.71974\r\n-2.15944 -1.59797 -3.47658\r\n-2.26688 2.01848 2.54814\r\n4.1681 -1.80084 2.28088\r\n3.89452 4.87041 -1.88276\r\n-1.95294 0.0568 0.97409\r\n4.239 3.91088 0.41099\r\n2.96781 0.70961 2.15738\r\n-2.1717 -3.75091 0.3893\r\n3.25464 -4.68435 0.4317\r\n4.61822 0.16345 -0.8137\r\n3.63148 0.50627 -1.29523\r\n-3.82892 2.62826 1.35222\r\n1.66474 -4.52266 2.97421\r\n3.25534 -1.39494 1.78199\r\n-0.90005 3.0701 0.91511\r\n2.87828 -4.27313 -4.54211\r\n3.37071 -3.23734 2.04145\r\n4.10477 -1.49928 -0.97552\r\n4.304 -2.73254 1.79068\r\n1.9917 -0.31307 4.64524\r\n-3.22671 0.11052 -3.57458\r\n4.34446 -2.14067 4.93434\r\n-3.19734 4.95321 1.1598\r\n-4.37349 1.80834 -1.68917\r\n-3.92747 3.8088 -3.07921\r\n-1.6773 4.11433 -1.18049\r\n0.10155 -2.77298 0.66294\r\n-0.26781 2.6736 3.9556\r\n-2.538 -3.79081 4.649\r\n-3.18027 3.79856 1.37759\r\n2.45133 4.32558 1.92434\r\n0.9171 4.48015 -4.00032\r\n3.17423 4.54057 3.7038\r\n-2.50368 0.22419 4.01958\r\n4.34365 2.20244 -1.97407\r\n-1.44398 -2.64187 1.25688\r\n2.68701 -0.02563 -1.02175\r\n3.74208 -2.90774 3.03982\r\n2.10525 -1.61148 -1.39735\r\n4.31085 0.28171 2.44647\r\n-0.98274 0.63186 0.71255\r\n-3.41407 -1.66255 2.12739\r\n4.9308 -3.72135 1.99512\r\n2.81052 -0.31371 -4.18027\r\n3.21478 -0.29488 -2.8816\r\n-3.63227 -1.6724 -0.31476\r\n1.75033 -4.64032 -0.00318\r\n-1.39523 -3.46619 -4.61081\r\n-1.64184 3.3747 3.44059\r\n3.35852 1.6191 -0.81635\r\n1.86514 0.58676 1.63022\r\n-3.04901 -3.20558 0.08267\r\n1.92483 2.27034 1.49841\r\n-4.91498 1.41326 2.80465\r\n2.69845 0.45729 -2.21871\r\n3.75389 -4.6027 -0.52556\r\n1.13461 -4.97148 -2.16714\r\n3.71984 -4.05981 2.66989\r\n-3.04962 -4.69185 -2.26368\r\n4.01225 3.79833 -3.10546\r\n-0.23654 -4.85365 -1.97844\r\n3.27401 -4.3434 3.49522\r\n0.35645 -3.12555 -4.91376\r\n4.93328 3.13717 -0.60734\r\n-0.88847 -0.30048 0.26498\r\n-2.42181 -3.30887 1.52845\r\n0.43681 -1.16064 1.49265\r\n0.44697 1.58356 -2.27595\r\n-2.74112 -1.84951 0.31078\r\n1.00819 -0.74522 -4.49912\r\n0.23969 -0.53862 -0.11053\r\n-1.64239 1.27146 4.09021\r\n-4.28778 -1.75789 3.94173\r\n1.4305 1.41946 3.47909\r\n-4.22058 -4.61042 1.49929\r\n-3.47118 1.11409 -2.12763\r\n-2.77527 -2.81944 -3.57947\r\n2.06771 -1.08578 -4.36386\r\n-1.43723 -1.43009 1.49699\r\n-0.27772 1.95807 -4.63379\r\n-0.79438 -0.60375 2.84683\r\n1.30992 -1.21739 2.08015\r\n2.32867 -3.05371 3.3221\r\n3.71984 -4.44489 4.39153\r\n1.0204 -0.17899 1.51032\r\n3.21297 -1.79902 2.95036\r\n0.97028 -0.72017 4.39529\r\n1.49225 -2.10115 3.81584\r\n-3.69753 -3.88641 3.93411\r\n-3.83133 4.60439 2.17023\r\n-1.00202 -1.75724 -3.86356\r\n0.69366 4.23913 -1.4015\r\n0.43519 -2.75102 3.81972\r\n-3.85433 3.19679 -2.11004\r\n-0.28772 0.84344 1.66002\r\n4.48687 2.56215 0.26103\r\n-3.53828 0.77089 -4.59526\r\n-4.87188 4.47854 -2.59409\r\n3.76835 2.85253 -0.95692\r\n3.76109 -2.74044 4.22231\r\n-1.96054 3.12368 2.11075\r\n4.13161 1.45537 -0.11001\r\n-2.02929 0.76175 3.22845\r\n0.24764 0.65659 -1.94364\r\n-0.73972 -2.16144 0.44963\r\n4.57417 4.40168 -1.26471\r\n-0.80931 -1.78628 2.66358\r\n-0.28684 -4.45787 -0.23232\r\n-4.81506 -2.61972 3.48239\r\n0.68567 0.5686 0.3661\r\n1.88267 1.76265 -1.56305\r\n-4.53201 -4.85104 -3.64538\r\n2.3396 -0.29311 1.21641\r\n1.40238 -2.36939 1.80138\r\n-3.43122 -2.51029 3.7692\r\n-4.55728 4.06854 2.67771\r\n-0.68725 1.99186 0.92098\r\n-4.27709 4.33918 1.14867\r\n0.34209 0.58042 -3.94305\r\n4.16253 -3.3005 0.47877\r\n-4.97106 -4.65618 4.07253\r\n0.93223 -1.44184 3.127\r\n-1.47505 3.28668 -2.14028\r\n2.22215 2.50236 -0.65751\r\n1.46926 0.88656 -1.23377\r\n-1.83341 -2.06021 3.41235\r\n-3.99549 -0.04677 -2.72149\r\n-4.30519 0.60144 3.78686\r\n1.03764 2.58719 -4.3605\r\n-2.14153 4.33459 -4.50689\r\n-4.79254 -2.83693 2.36832\r\n4.39725 -4.18904 -4.6615\r\n-3.874 1.76214 -3.6396\r\n-2.62864 -3.18774 2.57631\r\n-3.61336 2.80555 -3.37678\r\n4.99838 -0.48571 0.23408\r\n-2.64695 3.93215 3.45605\r\n0.36809 3.91176 2.83697\r\n-0.35078 -2.6667 3.19201\r\n-2.5029 -0.50923 -2.55481\r\n-3.57622 -3.97773 -3.07411\r\n1.2544 3.22096 4.06806\r\n-1.65674 -3.00206 2.29722";
                foreach (var line in pozycje.Split('\n'))
            {
                string[] temppos = line.ToString().Split(' ');
                Particle tempparticle = new Particle();
                tempparticle.pos.x = double.Parse(temppos[0]);
                tempparticle.pos.y = double.Parse(temppos[1]);
                tempparticle.pos.z = double.Parse(temppos[2]);
                particles.Add(tempparticle);
            } }

            public void Initialize(int Num_of_part, double dt)
        {
            
            int col, row,layer;
            double kin;
            col = 0;
            row = 0;
            layer = 0;
            particles.Clear();
            for (int i = 0; i < Num_of_part; i++)
            {
                Particle tempparticle = new Particle();
                tempparticle.f.x = 0;
                tempparticle.f.y = 0;
                tempparticle.f.z = 0;
                tempparticle.pos.x = row * 1.0 + (rnd() - 0.5) * 0.01;
                tempparticle.v.x = (tempparticle.pos.x - (row * 1.0)) / dt;
                tempparticle.pos.y = 0.866 * col + 0.5 + (rnd() - 0.5) * 0.01;
                tempparticle.v.y = (tempparticle.pos.y - 0.866 * col) / dt;
                tempparticle.pos.z = layer*1.0+ (rnd() - 0.5) * 0.01;
                tempparticle.v.z = (layer -tempparticle.pos.z) / dt;
                if (col % 2 == 0) tempparticle.pos.x += 0.5;
                row++;
                if (row > (l - 1))
                {
                    row = 0;
                    col++;
                };
                if (col > (l - 1)) 
                { row = 0;col = 0; layer++; };
                particles.Add(tempparticle);
            }
            RemoveVelocity();
            kin = CalculateKinetic();
            Thermostat(kin);
        }
        public void RemoveVelocity() {
            double sumvx, sumvy,sumvz;
            int size;
            size = particles.Count;
            sumvx = 0;
            sumvy = 0;
            sumvz = 0;
            for (int i = 0; i < size; i++)
            {
                sumvx += particles[i].v.x;
                sumvy += particles[i].v.y;
                sumvz += particles[i].v.z;
            }
            for (int i = 0; i < size; i++)
            {
                particles[i].v.x -= sumvx / size;
                particles[i].v.y -= sumvy / size;
                particles[i].v.z -= sumvz / size;
            }
        }
        public double CalculateKinetic()
        {
            double tempkin, vx, vy,vz;
            tempkin = 0;
            for (int i = 0; i < particles.Count; i++)
            {
                vx = particles[i].v.x;
                vy = particles[i].v.y;
                vz= particles[i].v.y; 
                tempkin +=  (vx * vx + vy * vy+vz*vz);
            }
            return tempkin;
        }
        public void Thermostat( double kin)
        {
            const double T= 0.85;
            double beta;
            int n;
            n = particles.Count;
            beta = Sqrt((n - 1) * T / kin);
            //Console.WriteLine("beta " + beta);
            for (int i = 0; i < n; i++)
            {
                particles[i].v.x *= beta;
                particles[i].v.y *= beta;
                particles[i].v.z *= beta;
            }

        }
        public void Evolve(double dt)
        {
            t += dt;
            for (int i = 0; i < particles.Count; i++)
            {
                particles[i].pos.x += particles[i].v.x * dt + 0.5 * dt * dt * particles[i].f.x;
                particles[i].pos.y += particles[i].v.y * dt + 0.5 * dt * dt * particles[i].f.y;
                particles[i].pos.z += particles[i].v.z * dt + 0.5 * dt * dt * particles[i].f.z;
                if (particles[i].pos.x > l) particles[i].pos.x -= Floor(particles[i].pos.x / l) * l;
                if (particles[i].pos.y > l) particles[i].pos.y -= Floor(particles[i].pos.y / l) * l;
                if (particles[i].pos.z > l) particles[i].pos.z -= Floor(particles[i].pos.z / l) * l;
                if (particles[i].pos.x < 0) particles[i].pos.x += Floor(Abs(particles[i].pos.x / l) + 1) * l;
                if (particles[i].pos.y < 0) particles[i].pos.y += Floor(Abs(particles[i].pos.y / l) + 1) * l;
                if (particles[i].pos.z < 0) particles[i].pos.z += Floor(Abs(particles[i].pos.z / l) + 1) * l;
            }
            CalculateNewForcesAndPotential();
            //std::cout<<i<<std::endl;
            for (int i = 0; i < particles.Count; i++)
            {
                particles[i].v.x += 0.5 * dt * (particles[i].nf.x + particles[i].f.x);
                particles[i].v.y += 0.5 * dt * (particles[i].nf.y + particles[i].f.y);
                particles[i].v.z += 0.5 * dt * (particles[i].nf.z + particles[i].f.z);


            }
            for (int i = 0; i < particles.Count; i++)
            {
                particles[i].f.x = particles[i].nf.x;
                particles[i].f.y = particles[i].nf.y;
                particles[i].f.z = particles[i].nf.z;
            }
        }
        public void CalculateNewForcesAndPotential()
        {
            double distx, disty,distz, radial, temppot, force12, force6;
            //Console.WriteLine("New Force");
            temppot = 0;
            pot = 0;
            for (int i = 0; i < particles.Count; i++)
            {
                particles[i].nf.x = 0;
                particles[i].nf.y = 0;
                particles[i].nf.z = 0;
            }
            for (int i = 0; i < particles.Count-1; i++)
            {
                for (int j =i+1; j < particles.Count ; j++)
                {
                    if (i != j)
                    {
                        distx = particles[i].pos.x - particles[j].pos.x;
                        if (distx > (l / 2)) distx -=  l;
                        if (distx < (-l / 2)) distx += l;
                        disty = particles[i].pos.y - particles[j].pos.y;
                        if (disty > (l / 2)) disty -= l;
                        if (disty < (-l / 2)) disty += l;
                        distz = particles[i].pos.z - particles[j].pos.z;
                        if (distz > (l / 2)) distz -= l;
                        if (distz < (-l / 2)) distz += l;
                        radial = Math.Sqrt(distx * distx + disty * disty+distz*distz);
                        if (radial <9)
                        {
                            force12 = Pow(radial, -12);
                            force6 = Pow(radial, -6);
                            temppot += 4.0 * (force12 - force6);///( particles.Count);
                            double tfx = 48 * distx * (force12 / radial - 0.50 * force6 / radial);
                            double tfy = 48 * disty * (force12 / radial - 0.50 * force6 / radial);
                            double tfz = 48 * distz * (force12 / radial - 0.50 * force6 / radial);
                            particles[i].nf.x += tfx;
                            particles[j].nf.x -= tfx;
                            particles[i].nf.y += tfy;
                            particles[j].nf.y -= tfy;
                            particles[i].nf.z += tfz;
                            particles[j].nf.z -= tfz;

                            //Console.WriteLine("" + i+ " "+j+" "+distx+" "+disty+" "+radial+" "+ 4.0 * (force12 - force6) +" "+ tfx/ Math.Sqrt(tfx * tfx + tfy * tfy) + " "+tfy/ Math.Sqrt(tfx * tfx + tfy * tfy) + " "+Math.Sqrt(tfx*tfx+tfy*tfy));
                        }
                    }
                }
            }
            pot = temppot;
        }
        public double Ulrc(double rc)
        {
            double rho = particles.Count / (l * l * l);
            return (8.0/3.0)*Math.PI*rho*((1/3)*Pow(rc,-9)-Pow(rc,-3));
        }
        public void CalculateForcesAndPotential()
        {
            double distx, disty, distz, radial, temppot, force12, force6;
            
            temppot = 0;
            pot = 0;
            for (int i = 0; i < particles.Count; i++)
            {
                particles[i].f.x = 0;
                particles[i].f.y = 0;
                particles[i].f.z = 0;
            }
            for (int i = 0; i < particles.Count-1; i++)
            {
                for (int j = i + 1; j < particles.Count; j++)
                {
                    
                    
                        distx = particles[i].pos.x - particles[j].pos.x;
                        if (distx > (l / 2)) distx -= l;
                        if (distx < (-l / 2)) distx += l;
                        disty = particles[i].pos.y - particles[j].pos.y;
                        if (disty > (l / 2)) disty -= l;
                        if (disty < (-l / 2)) disty += l;
                        distz = particles[i].pos.z - particles[j].pos.z;
                        if (distz > (l / 2)) distz -= l;
                        if (distz < (-l / 2)) distz += l;
                        radial = Math.Sqrt(distx * distx + disty * disty+distz*distz);
                        if (radial <= 9)
                        {
                            force12 = Pow(radial, -12);
                            force6 = Pow(radial, -6);
                            temppot += 4.0 * (force12 - force6);// - (2*Math.PI*particles.Count/(l*l*l))* 0.119575; // / (particles.Count * particles.Count);
                            double tfx = 48 * distx * (force12 / radial - 0.50 * force6 / radial);
                            double tfy = 48 * disty * (force12 / radial - 0.50 * force6 / radial);
                            double tfz = 48 * distz * (force12 / radial - 0.50 * force6 / radial);
                            particles[i].f.x += tfx;//48 * distx * (force12 / radial - 0.50 * force6 / radial);
                            particles[j].f.x -= tfx;// 48 * distx * (force12 / radial - 0.50 * force6 / radial);
                            particles[i].f.y += tfy;// 48 * disty * (force12 / radial - 0.50 * force6 / radial);
                            particles[j].f.y -= tfy;// 48 * disty * (force12 / radial - 0.50 * force6 / radial);
                            particles[i].f.z += tfz;
                            particles[j].f.z -= tfz;
                            //                          Console.WriteLine("" + i + " " + j + " " + distx + " " + disty + " " + radial + " " + 4.0 * (force12 - force6) + " " + tfx / Math.Sqrt(tfx * tfx + tfy * tfy) + " " + tfy / Math.Sqrt(tfx * tfx + tfy * tfy) + " " + Math.Sqrt(tfx * tfx + tfy * tfy));
                            /*
                            force12 = Pow(radial, -6.0);
                            force6 = Pow(radial, -3.0);
                            temppot += 8.0 * (force12 - force6)/(particles.Count* particles.Count);
                            particles[i].f.x += 48 * distx * (force12 / radial - 0.50 * force6 / radial);
                            particles[j].f.x -= 48 * distx * (force12 / radial - 0.50 * force6 / radial);
                            particles[i].f.y += 48 * disty * (force12 / radial - 0.50 * force6 / radial);
                            particles[j].f.y -= 48 * disty * (force12 / radial - 0.50 * force6 / radial); */
                            //                            Console.WriteLine("F12 f6 " + force12 + " " + force6+ " " + 48 * disty * (force12 / radial - 0.50 * force6 / radial));
                        }
                    
                }
            }
            pot = temppot;
        }
        public string Dumppositions()
        {
            string temp="";
            for (int i=0;i<particles.Count;i++){
                temp += particles[i].pos.x + " " + particles[i].pos.y+" " + particles[i].pos.z+"\r\n";
            }
            return temp;
        }
        public string Dumpvelo()
        {
            string temp = "";
            for (int i = 0; i < particles.Count; i++)
            {
                temp += particles[i].v.x + " " + particles[i].v.y + " " + particles[i].v.z+ "\r\n";
            }
            return temp;
        }
        public string Dumpdistances()
        {
            StringBuilder sb = new StringBuilder("");
            for (int i = 0; i < particles.Count; i++)
            {
                for (int j = 0; j < i; j++)
                {
                    double dist = particles[i].pos.BoxDistance(particles[j].pos,l);
                    sb.Append(i+"  "+j+" "+dist+"\r\n");//Math.Sqrt(Pow(distx, 2) + Pow(disty, 2)) + "\r\n");
                }
                
            }
            return sb.ToString();
        }
    }

}

